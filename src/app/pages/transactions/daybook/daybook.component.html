<form [formGroup]="filterForm" (ngSubmit)="submitFilter()">
  <nb-card>
    <nb-card-header>Filters</nb-card-header>
    <nb-card-body>
      <div class="row g-2">
        <div class="col-6 col-md-3">
          <label>Rooms</label>
          <nb-select placeholder="Select Rooms" formControlName="rooms" multiple fullWidth>
            <nb-option *ngFor="let room of roomList" [value]="room.id">{{ room.name }}</nb-option>
          </nb-select>
        </div>

        <div class="col-6 col-md-3">
          <label>Students</label>
          <nb-select placeholder="Select Students" formControlName="students" multiple fullWidth>
            <nb-option *ngFor="let student of studentList" [value]="student.id">{{ student.name }}</nb-option>
          </nb-select>
        </div>

        <div class="col-6 col-md-3">
          <label>Gender</label>
          <nb-select placeholder="Select Gender" formControlName="genders" multiple fullWidth>
            <nb-option value="Male">Male</nb-option>
            <nb-option value="Female">Female</nb-option>
          </nb-select>
        </div>

        <div class="col-6 col-md-3">
          <label>From Date</label>
          <input nbInput type="date" formControlName="fromDate" fullWidth>
        </div>

        <div class="col-6 col-md-3">
          <label>To Date</label>
          <input nbInput type="date" formControlName="toDate" fullWidth>
        </div>
      </div>

      <button nbButton status="primary" type="submit" class="mt-3">Apply Filters</button>
    </nb-card-body>
  </nb-card>
</form>

<!-- Desktop Ledger Table -->
<div class="daybook-table d-none d-md-block mt-3">
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Date</th>
        <th>Particulars</th>
        <th>Student</th>
        <th>Room</th>
        <th class="text-end">Debit</th>
        <th class="text-end">Credit</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let entry of daybookEntries" 
          [ngClass]="{
            'opening-balance': entry.entryType==='OPENING BALANCE',
            'period-total': entry.entryType==='PERIOD TOTAL',
            'closing-balance': entry.entryType==='CLOSING BALANCE'
          }">
        <td>{{ entry.entryType==='TRANSACTION' ? (entry.entryDate | date:'shortDate') : '' }}</td>
        <td>{{ entry.particulars }}</td>
        <td>{{ entry.studentName || '-' }}</td>
        <td>{{ entry.roomNo || '-' }}</td>
        <td class="text-end debit">{{ entry.debit | number:'1.2-2' }}</td>
        <td class="text-end credit">{{ entry.credit | number:'1.2-2' }}</td>
      </tr>
    </tbody>
    
  </table>
</div>

<!-- Mobile Cards -->
<div class="daybook-cards d-md-none mt-3">
  <nb-card *ngFor="let entry of daybookEntries" 
           [ngClass]="{
            'opening-balance': entry.entryType==='OPENING BALANCE',
            'period-total': entry.entryType==='PERIOD TOTAL',
            'closing-balance': entry.entryType==='CLOSING BALANCE'
           }"
           class="mb-2">
    <nb-card-body>
      <div class="fw-bold">{{ entry.particulars }}</div>
      <div class="small text-muted" *ngIf="entry.entryType==='TRANSACTION'">
        {{ entry.entryDate | date:'shortDate' }}
      </div>
      <div>Student: {{ entry.studentName || '-' }}</div>
      <div>Room: {{ entry.roomNo || '-' }}</div>
      <div class="d-flex justify-content-between mt-1">
        <span>Debit: {{ entry.debit | number:'1.2-2' }}</span>
        <span>Credit: {{ entry.credit | number:'1.2-2' }}</span>
      </div>
    </nb-card-body>
  </nb-card>
</div>
