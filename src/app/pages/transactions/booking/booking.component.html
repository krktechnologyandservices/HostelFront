<nb-card>
  <nb-card-header>
    Bookings
    <button nbButton status="success" size="small" style="float:right" (click)="addBooking()">Add Booking</button>
  </nb-card-header>

  <nb-card-body>
    <div style="margin-bottom:10px;">
      <input nbInput placeholder="Search by student, room, period, status" [(ngModel)]="searchQuery">
      <button nbButton status="info" size="tiny" (click)="search()">Search</button>
      <button nbButton status="secondary" size="tiny" (click)="searchQuery=''; search()">Reset</button>
    </div>

    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Student</th>
          <th>Room</th>
          <th>Tariff</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Vocation Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let b of filteredBookings">
          <td>{{ getStudentName(b.studentId) }}</td>
          <td>{{ getRoomNumber(b.roomId) }}</td>
          <td>{{ b.tariffPeriod }}</td>
          <td>{{ b.startDate | date }}</td>
          <td>{{ b.endDate | date }}</td>
          <td>â‚¹{{ b.amount }}</td>
          <td>{{ b.status }}</td>
          <td>{{ b.vocationDate ? (b.vocationDate | date:'shortDate') : '-' }}</td>
          <td>
            <button nbButton size="tiny" status="info" (click)="editBooking(b)" *ngIf="b.status!='Cancelled'">Edit</button>
            <button nbButton size="tiny" status="warning" (click)="openVocationModal(b)" *ngIf="b.status!='Cancelled'">Vocate</button>
            <button nbButton size="tiny" status="danger" (click)="deleteBooking(b)" *ngIf="b.status!='Cancelled'">Cancel</button>
            
          </td>
        </tr>
      </tbody>
    </table>
  </nb-card-body>
</nb-card>

<!-- Vocation Modal -->
<nb-card *ngIf="showVocationModal" style="position: fixed; top: 20%; left: 35%; width: 30%; z-index: 1000; padding:20px;">
  <nb-card-header>Update Vocation</nb-card-header>
  <nb-card-body>
    <input nbInput type="date" [(ngModel)]="vocationDate">
  </nb-card-body>
  <nb-card-footer>
    <button nbButton status="primary" (click)="saveVocation()">Save</button>
    <button nbButton status="danger" (click)="showVocationModal=false">Cancel</button>
  </nb-card-footer>
</nb-card>
